<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<HEAD>
   <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
   <META NAME="GENERATOR" CONTENT="Mozilla/4.08 [en] (Win95; I) [Netscape]">
   <META NAME="Author" CONTENT="Eric Phelps">
   <META NAME="Description" CONTENT="File decoder for Content-Type: application/ms-tnef">
   <TITLE>Extracting files from application/ms-tnef attachments</TITLE>
</HEAD>
<BODY TEXT="#000000" BGCOLOR="#FFFFFF" LINK="#0000EE" VLINK="#551A8B" ALINK="#FF0000" BACKGROUND="tile.gif">
&nbsp;
<TABLE CELLSPACING=0 WIDTH="100%" >
<TR>
<TD ALIGN=LEFT VALIGN=BOTTOM>
<CENTER><A HREF="~webspace.html"><IMG SRC="smallduck.gif" ALT="Eric's Webspace" HSPACE=10 BORDER=0 HEIGHT=71 WIDTH=150></A></CENTER>
</TD>

<TD ALIGN=LEFT VALIGN=BOTTOM WIDTH="100%">
<CENTER><B><I><FONT SIZE=+3>Extracting files from application/ms-tnef attachments</FONT></I></B></CENTER>
</TD>
</TR>
</TABLE>

<TABLE CELLSPACING=0 CELLPADDING=0 WIDTH="100%" BGCOLOR="#666699" >
<TR>
<TD WIDTH="100%">
<DIV ALIGN=right><A HREF="http://www.calweb.com/~webspace/tnef/tnef.zip"><IMG SRC="tnef.gif" BORDER=0 HEIGHT=32 WIDTH=32></A><A HREF="http://www.calweb.com/~webspace/tnef/tnef.zip"><IMG SRC="download.gif" ALT="Download Now!" BORDER=0 HEIGHT=19 WIDTH=130></A></DIV>
</TD>
</TR>
</TABLE>

<TABLE>
<TR>
<TD><IMG SRC="100.gif" HEIGHT=1 WIDTH=100></TD>

<TD WIDTH="100%">I use Microsoft Outlook at work and Netscape at home.
If I try to send a file to my home, it comes through as an "application/ms-tnef"
attachment with no file name. Spending a bit of time looking, I found out
that Microsoft came up with their own encapsulation format so they could
handle special Outlook things like sending appointments back and forth.
Unfortunately, they made it so hard to turn off this pain-in-the-butt format
that not one in a hundred Outlook users can do it. So I have to put up
with getting useless attachments.
<P><IMG SRC="mstnef.gif" HEIGHT=316 WIDTH=266 ALIGN=LEFT>So I wrote a quick
and dirty program to help me extract files from the ms-tnef attachment.
If I was any good, I'd have studied all about the ms-tnef format. But I'm
not. I noticed that the desired files are byte-for-byte intact inside the
ms-tnef stuff. So all I do is look for the file header for the file I want.
Sure, some files don't have standard headers, but the stuff I want does.
When I find a known file header, I extract everything starting at that
point. Again, none of the files I use care if there is extra stuff on their
ends. So it works for me.
<P>Maybe I'll clean up the GUI a bit one day. But maybe somebody else (like
Winzip?) will come up with native ms-tnef support so I won't have to.
<P><B>Click the "Download Now!" icon at the top of this page</B> to get
the program and all source code. The program is written in Visual Basic
5. More than likely you already have the VB5 runtime files that are needed
(just try running the program to see if it works!), but if you don't, you
can get them here:
<BR><A HREF="ftp://ftp.microsoft.com/Softlib/MSLFILES/MSVBVM50.EXE">Microsoft
VB5 Runtime files</A>&nbsp;
<BR><A HREF="http://www.hotfiles.com/?000LU3">Generic VB5 Runtime files</A></TD>
</TR>
</TABLE>

<TABLE WIDTH="100%" >
<TR>
<TD><IMG SRC="100.gif" ALT="100 pixel spacer" HEIGHT=1 WIDTH=100></TD>

<TD WIDTH="100%"></TD>
</TR>
</TABLE>

<CENTER>
<P>Bad links? Questions? <A HREF="mail.htm">Send
me mail</A>.</CENTER>

<BR>&nbsp;
<P><BR>
<BR>
<BR>
<BR>
<BR>
<BR>
<BR>
<BR>
</BODY>
</HTML>
