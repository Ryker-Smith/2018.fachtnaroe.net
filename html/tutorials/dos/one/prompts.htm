<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
<HEAD>
   <TITLE>Batch Programming: Capturing Prompts</TITLE>
   <META NAME="Author" CONTENT="Eric Phelps">
   <META NAME="GENERATOR" CONTENT="Mozilla/3.01Gold (Win95; I) [Netscape]">
</HEAD>
<BODY>

<H2 ALIGN=CENTER>Batch Programming: Capturing Prompts</H2>

<CENTER><P>
<HR WIDTH="100%"><I>Prompts always show up at the beginning of a line,
so the ability to capture the entire line, prompt and all, gives us another
way to prefix desired words onto an existing line</I> 
<HR WIDTH="100%"></P></CENTER>

<P>In this example, we will change a prompt to the phrase <B><TT>set value=
</TT></B>in order to get it on the same line with -- and preceeding --
the phrase <B><TT>Your command output goes here!</TT></B> The trick used
here is redirection. Although we can't redirect the output of a batch file,
we can redirect the output of .COM file. When <B>command.com</B> is run
as a separate session, the entire output of that session, prompts and all,
can be redirected. </P>

<P><B><TT>@echo off <BR>
echo @prompt set value$Q&gt; 1.bat<BR>
echo Your Command Output Goes Here!&gt;&gt; 1.bat<BR>
echo @prompt $H&gt;&gt; 1.bat<BR>
command /c 1.bat &gt; 2.bat<BR>
<BR>
</TT></B>Notice the two additional files generated. 1.BAT is generated
on-the-fly, and 2.BAT is the desired output. After generating 1.BAT , COMMAND
runs it. 1.BAT will change the prompt to the desired phrase, then run the
&quot;Your Command...&quot; line. At this point our command prompt is<BR>
<B><TT>set value=<BR>
</TT></B>and the command is <BR>
<B><TT>Your Command Output Goes Here!<BR>
</TT></B>so the on-screen display (if you could see it for the millisecond
it exists) is<BR>
<B><TT>set value=Your Command Output Goes Here!<BR>
</TT></B>We next change the prompt to something invisible ( I chose $H,
a backspace) to keep the output clean. That's it. The entire session is
redirected into 2.BAT.&nbsp;If you wanted, you could CALL 2.BAT at this
point. </P>

<P>Problems: <BR>
(1) &nbsp;Obviously, the first word of the &quot;Your Command...&quot;
line MUST&nbsp;NOT&nbsp;be a valid command. Since there is no command called
&quot;YOUR&quot;, we're okay on this example. If you want to be sure, <A HREF="numbring.htm">poison
your lines by numbering them.<BR>
</A>(2)&nbsp;&nbsp;Since there is no command called YOUR, we get a &quot;Bad
command or file name&quot; message displayed directly to the screen. It
doesn't get redirected. To stop this from appearing, put <B><TT>ctty nul</TT></B>
just before the <B><TT>command /c</TT></B> line, and put <B><TT>ctty con</TT></B>
just after the <B><TT>command /c</TT></B> line.<BR>
(3)&nbsp;&nbsp;The output file has a couple extra blank lines due to all
those invisible commands we run. Pipe the output of the <B><TT>command
/c</TT></B> line through FIND, looking for &quot;set value=&quot; before
redirecting it into 2.BAT.</P>

<P>If you read more about the PROMPT command, you'll find several built-in
prompts you can capture which would be otherwise awkward to come by.</P>
<P><CENTER>Bad links? Questions? <A HREF="mail.htm">Send me mail</A>.</CENTER>
</BODY>
</HTML>
