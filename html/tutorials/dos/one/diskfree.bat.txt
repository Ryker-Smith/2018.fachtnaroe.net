@echo off
:: Parses the output of the dir command to get
:: the free space on a disk. Uses debug to trim
:: away all unwanted info from the response line.
set diskfree=
deltree /y ~~~ > nul
md ~~~
dir ~~~ | find "dir" > ~dfree.bat
deltree /y ~~~ > nul
set diskfree=
>  script echo f 0100 l 11 20
>> script echo e 0104 "set diskfree="
>> script echo rcx
>> script echo 21
>> script echo w
>> script echo q
debug ~dfree.bat < script > nul
del script
call ~dfree.bat
del ~dfree.bat
echo disk free space is %diskfree%