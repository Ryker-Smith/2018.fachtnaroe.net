@echo off
echo Please wait while renaming all VXE files to EXE...
:: Renames all .VXE files to .EXE on the C: drive
:: Code derived from 
:: http://www.calweb.com/~webspace/batch/lists/filelist.htm

rem ******************* MAGIC HAPPENS HERE *******************
:: Create the list of vxe files
dir /s /b c:\*.vxe > filelist.txt
rem ******************* MAGIC HAPPENS HERE *******************
:: Create the PROCESS.BAT
echo ren "%%filename%%" "*.exe"> process.bat
rem ******************* MAGIC HAPPENS HERE *******************

:: Create the FRAGMENT.TXT
:: See http://www.calweb.com/~webspace/batch/lines/frag-dbg.htm
echo e 100 "set filename="> script
echo rcx>> script
echo d>> script
echo n fragment.txt>> script
echo w>> script
echo q>>script
debug < script > nul
del script

:START
copy fragment.txt + filelist.txt temp.txt > nul
type temp.txt | find "set filename=" > temp.bat
echo call process.bat >> temp.bat
call temp.bat
type temp.txt | find /v "set filename=" > filelist.txt
copy filelist.txt nul | find "0" > nul
if errorlevel 1 goto START

:: Delete temporary files
del temp.bat
del filelist.txt
del temp.txt
del fragment.txt
del process.bat
cls