<!DOCTYPE html>
<!--#include virtual="/includes/head.shtml" -->
<body onload="onloadProc()">
<!--#include virtual="/includes/inprogress.shtml" -->
<!--#include virtual="/includes/animation.shtml" -->
<div id="pagewrap">
<!--#include virtual="/includes/sitename.shtml" -->
<div id="topstripe"></div>
<!--#include virtual="/includes/sidemenu.shtml" -->
<div id="content">
<!--#include virtual="/includes/topblurb.shtml" -->
<h1>SDLx::App call-back based game loop</h1>
<p>Very simplistic sound generation - requires speakers! Use the space bar to play sound.</p>
<p>You'll need <a href="GunFire_01.wav">this .wav file</a>. (Right-click and choose 'Save ...').
<pre>
#!/usr/bin/perl
use strict;
# Purpose: 
# Date:   2013
# Author: Fachtna Roe

use SDL; #needed to get all constants
use SDLx::App;
use SDL::Event;
use SDL::Mouse;
use SDLx::Sound;

my ($total, $count) = (0,0);
my ($application, $bomb_sound, $playing);
$playing = 0;
# First create a new App
$application = SDLx::App-&gt;new(
    title  =&gt; "Generic Space Game",
    width  =&gt; 800, # use same width as background image
    height =&gt; 600, # use same height as background image
    depth  =&gt; 16, 
    exit_on_quit =&gt; 1 # Enable 'X' button
);

# Add event handler for quit (covered also by 'q' of 'x' from keyboard)
$application-&gt;add_event_handler( \&amp;quit_event);
$application-&gt;add_event_handler(\&amp;mouse_event);
$application-&gt;add_event_handler(\&amp;key_event);

$bomb_sound = SDLx::Sound-&gt;new();
$bomb_sound-&gt;load('GunFire_01.wav');

SDL::Video::update_rects($application);

# set key repeat on after 100ms, then every 0ms
SDL::Events::enable_key_repeat(1000, 1000);

# Start the game loop
$application-&gt;run;


sub quit_event {
  my ($event, $app) = @_;
	if($event-&gt;type == SDL_QUIT) {
    $app-&gt;stop;
  }
}

sub key_event {
  my ($event, $app) = @_;
  my $key_name = SDL::Events::get_key_name( $event-&gt;key_sym );  
  if ($key_name eq "space") {
    if ($playing == 0) {
      $playing=1;
      $bomb_sound-&gt;play('GunFire_01.wav');
    }
    else {
      $bomb_sound-&gt;stop();
      $playing = 0;
    }
  }
  elsif (($key_name eq "x") || ($key_name eq "X") ) {
    $app-&gt;stop;
  }

}

sub mouse_event {
  my ($event, $app) = @_;
  my ($mouse_mask,$mouse_x,$mouse_y)  = @{SDL::Events::get_mouse_state()};
}


</pre>
<small><!--#config timefmt="%Y%m%d-%H:%M" -->Last updated: <!--#flastmod file="SDLx-App-Sample_03.shtml" --></small>
</div> <!-- #content -->
<!--#include virtual="/includes/backtotop.shtml" -->
</div> <!-- #pagewrap -->
</body>
</html>
