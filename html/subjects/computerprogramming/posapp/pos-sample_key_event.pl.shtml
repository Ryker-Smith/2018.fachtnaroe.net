<!DOCTYPE html>
<!--#include virtual="/includes/head.shtml" -->
<body onload="onloadProc()">
<!--#include virtual="/includes/inprogress.shtml" -->
<!--#include virtual="/includes/animation.shtml" -->
<div id="pagewrap">
<!--#include virtual="/includes/sitename.shtml" -->
<div id="topstripe"></div>
<!--#include virtual="/includes/sidemenu.shtml" -->
<div id="content">
<!--#includes virtual="/includes/topblurb.shtml" -->
<h1>POS App: sample key_event loop</h1>
<p>This code sample shows how the GUI app can be used to read from the keyboard <i>without</i> using &lt;STDIN&gt;.
<pre>
my $symbol; # This should be declared globally

...

$end_sale = 0; 
while (!$end_sale) {
# Updates the queue to recent events
  SDL::Events::pump_events();
  # process all available events
  while (SDL::Events::poll_event($event)) {
    # check by Event type   
    if ($event-&gt;type == SDL_QUIT) {
      &amp;quit_event(); 
    }
    elsif ($event-&gt;type == SDL_KEYUP) {
      &amp;key_event($event);
    }
  } # event
} # sale
  
...  

sub key_event {
  my $key_name = SDL::Events::get_key_name( $event->key_sym );  
  if ($key_name =~ m/\d/) { # is this a digit?
    $symbol = $symbol . $key_name;  # if so, join it to existing $symbol
  }
  elsif (($key_name eq "v") || ($key_name eq "V")) {
    $symbol = $key_name;
    $count--; # reduce the items bought counter
    $total -= pop @r_price; 
    pop @r_name, @r_manf;    
  }
  elsif (($key_name eq "e") || ($key_name eq "E")) {
    $symbol = $key_name; 
    $end_sale = 1; # raise end_sale flag
  }
  elsif (($key_name eq "x") || ($key_name eq "X")) {
    $end_sale = 1; # raise flags to allow quick exit
    $exit_program = 1;
  }
  elsif ($key_name eq "return") { # only process symbols after RETURN
    &pos_processing ($symbol); # call the processing routine below, passing $symbol
    $symbol = ""; # now clear the symbol
  }
} # sub key_event

...

sub pos_processing {
# This is called by key_event above when RETURN is pressed
# in this way the program simulates the use of $barcode = &lt;STDIN&gt;
  my $barcode = @_[0]; # put the value passed into a local variable ...
  # ... so that I can call the API
  my @data = &product_detail($barcode);
...
  #
}
</pre>
<form><input type="button" value="Back" onclick="history.back()"></form>
<small><!--#config timefmt="%Y%m%d-%H:%M" -->Last updated: <!--#flastmod file="pos-sample_key_event.pl.shtml" --></small>
</div> <!-- #content -->
<!--#include virtual="/includes/backtotop.shtml" -->
</div> <!-- #pagewrap -->
</body>
</html>
